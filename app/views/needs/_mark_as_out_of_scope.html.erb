<div id="scope">
  <h2>
    Mark as out of scope
    <br/>
    <small>
      <% if @need.out_of_scope? %>
        <strong>This need is not in scope for GOV.UK</strong>
      <% elsif @need.duplicate_of.present? %>
        You can't mark this need as 'out of scope' because it's already closed as a duplicate
      <% else %>
        No solution to this need will be created on GOV.UK, although you can still edit the need
      <% end %>
    </small>
  </h2>
  <% if @need.out_of_scope? || @need.duplicate_of.present? %>
    <%= link_to "Mark as out of scope",
                "#",
                id: 'out-of-scope',
                disabled: "",
                class: "btn btn-disabled" %>
  <% else %>
    <%= link_to "Mark as out of scope",
                out_of_scope_need_path(@need),
                id: 'out-of-scope',
                class: "btn btn-danger" %>
  <% end %>
</div>

<script>
  $('#out-of-scope').
  attr('href', '#out-of-scope-modal').
  attr('data-toggle', 'modal').
  attr('role', 'button')
</script>

<% unless @need.out_of_scope? %>
  <div id="out-of-scope-modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="modal-out-of-scope-label" aria-hidden="true">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
      <h3 id="modal-out-of-scope-label">Mark as out of scope</h3>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to mark this need as out of scope? This can’t be changed.</p>
    </div>
    <div class="modal-footer">
      <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
      <%= button_to "Mark as out of scope",
                      descope_need_path(@need),
                      method: :put,
                      class: "btn btn-danger" %>
    </div>
  </div>
<% end %>
